# Header Spoofing

## Description

This challenge relies on **HTTP header manipulation**. A hidden page contains comments that specify two conditions you must meet in order to access the flag:

* You must appear to come from a specific website (checked through the **Referer** header).
* You must appear to use a specific browser / client (checked through the **User-Agent** header).

Because HTTP headers are entirely controlled by the client, an attacker can forge them easily and bypass such checks.

## How to Get the Flag

* Click the footer link, which leads to a hidden page.
* Open the page source. The HTML comments reveal that you must:

  * Use a specific **User-Agent**: `ft_bornToSec`
  * Come from a specific **Referer**: `https://www.nsa.gov/`
* Since headers can be modified manually, you can use `curl` to spoof both headers.

### Command Used

```sh
curl "http://localhost/index.php?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f" \
  -H "User-Agent: ft_bornToSec" \
  -H "Referer: https://www.nsa.gov/" > response.html
```

This returns a response containing the flag.

## Vulnerability Explanation

* Developers included sensitive hints inside HTML comments. While invisible to users normally, they are trivial to read through DevTools.
* The server trusts the **User-Agent** and **Referer** headers. These are fully editable by any client.

## Prevention of Vulnerability

* Never rely on client-controlled values (headers, cookies, hidden inputs) for access control.
* Do not place sensitive logic hints in HTML comments.
* Treat all incoming headers as untrusted and potentially forged.
